var SmartComposer=(()=>{var a=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports),n=a((l,r)=>{const s=t=>t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement;class o{constructor(t){this.isPredicating=!1;if(!t.target)throw new Error("config.target must be provided.");this.config=t,this.getTarget()}get isReady(){return!!this.target}get currentValue(){return this.target?.value}get composerValue(){return this.composerInput.value}get valueAfterPredict(){const[,...t]=this.currentValue.split(this.config.triggerKey);return t.join("")}getTarget(){const t=document.getElementById(this.config.target);s(t)&&(this.target=t)}attach(){if(this.isReady||this.getTarget(),this.isReady){const t=this.target.cloneNode(!1);if(s(t)){t.id="",this.composerInput=t;const e=this.checkParentPosition();if(e)this.insertComposerWithStyles(),this.attachElementEvent();else{const i=document.createElement("div");i.style.position="relative",this.target.parentNode.insertBefore(i,this.target),i.appendChild(this.target),this.insertComposerWithStyles(),this.attachElementEvent()}}}}clear(){console.log("clear"),this.composerInput.value="",this.predicted="",this.isPredicating=!1}insertPredictValue(t){this.predicted=t,this.predicted?(console.log(this.target.value,this.predicted),this.composerInput.value=this.valueBeforePredict+this.predicted):this.clear()}async callPredict(){return typeof this.config.predict!="function"?void 0:this.config.predict instanceof Promise?this.config.predict(this):Promise.resolve(this.config.predict(this))}insertComposerWithStyles(){this.target.parentElement.insertBefore(this.composerInput,this.target);const{color:t}=getComputedStyle(this.composerInput);this.composerInput.style.position="absolute",this.composerInput.style.color=t.replace(")",", 0.6)").replace("rgb","rgba"),this.composerInput.style.pointerEvents="none",this.composerInput.value="",this.composerInput.placeholder="",this.target.style.position="relative",this.target.style.background="transparent",this.target.setAttribute("aria-readonly","true")}checkParentPosition(){const t=getComputedStyle(this.target.parentElement),e=this.target.parentElement.childElementCount;return t.position==="relative"&&e===1}handleKeyDown(t){t.key==="Backspace"&&(this.insertPredictValue.call(this,""),this.isPredicating=!1),t.key==="Tab"&&(this.isPredicating&&(t.preventDefault(),this.target.value=this.valueBeforePredict+this.predicted,this.clear()))}handleInput(t){this.isPredicating?this.composerInput.value.startsWith(this.target.value)||this.callPredict().then(e=>{e?this.insertPredictValue(e):this.clear()}):t.data===this.config.triggerKey&&(this.isPredicating=!0,this.valueBeforePredict=this.target.value,this.config.defaultPredictValue&&this.insertPredictValue(this.config.defaultPredictValue))}attachElementEvent(){this.target.addEventListener("keydown",this.handleKeyDown.bind(this)),this.target.addEventListener("input",this.handleInput.bind(this))}}r.exports=o});return n();})();
//# sourceMappingURL=main.js.map
